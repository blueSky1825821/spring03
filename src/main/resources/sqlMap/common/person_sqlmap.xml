<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "classpath:/config/dtd/dtd/sql-map-2.dtd" >
<sqlMap namespace="com.spring.inaction.sql.baidu.test01.dao.impl.PersonDaoImpl">

    <resultMap id="personResultMap" class="com.spring.inaction.sql.baidu.test01.po.PersonDo">
        <result column="id" property="id"></result>
        <result column="sex" property="sex"></result>
        <result column="name" property="name"></result>
        <result column="hobby" property="hobby"></result>
    </resultMap>

    <sql id="baseColumn">
        id,
        sex,
        name,
        hobby
    </sql>

    <insert id="insertPerson">
        insert
        into person
        (id,
        sex,
        name,
        hobby)
        values(
        #id#,
        #sex#,
        #name#,
        #hobby#
        )
        <selectKey resultClass="long" keyProperty="id">
            select LAST_INSERT_ID() as id
        </selectKey>
    </insert>

    <select id="queryPerson" resultMap="personResultMap">
        select
        <include refid="baseColumn"/>
        from person WHERE 1=1
        <dynamic>
            <isNotNull property="id" prepend=" and ">
                id = #id#
            </isNotNull>
            <isNotNull property="name" prepend=" and ">
                name = #name#
            </isNotNull>
            <isNotNull property="sex" prepend=" and ">
                sex = #sex#
            </isNotNull>
        </dynamic>
    </select>

</sqlMap>